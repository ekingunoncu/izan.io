{
  "id": "bluesky-scrape-post",
  "name": "bluesky_scrape_post",
  "description": "Scrape a specific Bluesky post and its thread. Returns post content, author, engagement stats, replies, and embedded content.",
  "version": "1.0.0",
  "parameters": [
    { "name": "post_url", "type": "string", "description": "Bluesky post URL (e.g. 'https://bsky.app/profile/user.bsky.social/post/abc123')", "required": true }
  ],
  "steps": [
    { "action": "navigate", "url": "{{post_url}}", "label": "Open post" },
    { "action": "waitForSelector", "selector": "[data-testid='postText']", "timeout": 15000, "label": "Wait for post" },
    { "action": "wait", "ms": 2000 },
    { "action": "scroll", "direction": "down", "amount": 1500, "label": "Scroll for replies" },
    { "action": "wait", "ms": 1500 },
    {
      "action": "code",
      "code": "const threadItems = document.querySelectorAll('[data-testid^=\"postThreadItem-by-\"]'); const mainPost = threadItems.length > 0 ? threadItems[0] : document.querySelector('article, div[tabindex=\"0\"]'); let authorName = ''; let authorHandle = ''; const authorLink = mainPost ? mainPost.querySelector('a[href*=\"/profile/\"]') : document.querySelector('a[href*=\"/profile/\"]'); if (authorLink) { const href = authorLink.getAttribute('href') || ''; const match = href.match(/\\/profile\\/([^/]+)/); if (match) authorHandle = match[1]; const nameSpan = authorLink.querySelector('span'); if (nameSpan) authorName = nameSpan.textContent.trim(); } const contentEl = document.querySelector('[data-testid=\"postText\"]'); const likeBtn = mainPost ? mainPost.querySelector('[data-testid=\"likeBtn\"]') : document.querySelector('[data-testid=\"likeBtn\"]'); const replyBtn = mainPost ? mainPost.querySelector('[data-testid=\"replyBtn\"]') : document.querySelector('[data-testid=\"replyBtn\"]'); const timeEl = mainPost ? mainPost.querySelector('time') : document.querySelector('time'); const imgEl = document.querySelector('img[src*=\"feed_\"], img[src*=\"cdn.bsky\"]'); const replies = []; for (let i = 1; i < Math.min(threadItems.length, 15); i++) { const el = threadItems[i]; const rAuthorLink = el.querySelector('a[href*=\"/profile/\"]'); let rAuthor = ''; if (rAuthorLink) { const nameSpan = rAuthorLink.querySelector('span'); if (nameSpan) rAuthor = nameSpan.textContent.trim(); } const rContentEl = el.querySelector('[data-testid=\"postText\"]'); const rLikeBtn = el.querySelector('[data-testid=\"likeBtn\"]'); const rTimeEl = el.querySelector('time'); replies.push({ author: rAuthor, content: rContentEl ? rContentEl.textContent.trim().substring(0, 300) : '', likes: rLikeBtn ? (rLikeBtn.getAttribute('aria-label') || '') : '', time: rTimeEl ? (rTimeEl.getAttribute('datetime') || rTimeEl.textContent.trim()) : '' }); } return { author: authorName, handle: authorHandle, content: contentEl ? contentEl.textContent.trim() : '', likes: likeBtn ? (likeBtn.getAttribute('aria-label') || '') : '', replies_info: replyBtn ? (replyBtn.getAttribute('aria-label') || '') : '', time: timeEl ? (timeEl.getAttribute('datetime') || timeEl.textContent.trim()) : '', has_image: !!imgEl, image: imgEl ? imgEl.getAttribute('src') : '', replies: replies, url: window.location.href }",
      "name": "post_data",
      "label": "Extract post and thread"
    }
  ]
}