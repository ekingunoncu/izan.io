{
  "id": "myfitnesspal-scrape-diary",
  "name": "myfitnesspal_scrape_diary",
  "description": "Scrape MyFitnessPal food diary for a specific date. Requires login.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "date",
      "type": "string",
      "description": "Date in YYYY-MM-DD format",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "https://www.myfitnesspal.com/food/diary?date={{date}}",
      "label": "Open MyFitnessPal"
    },
    {
      "action": "waitForSelector",
      "selector": ".diary-table, [class*=\"diary\"], table, .content",
      "timeout": 15000,
      "label": "Wait for page"
    },
    {
      "action": "wait",
      "ms": 2500,
      "label": "Let page render"
    },
    {
      "action": "code",
      "code": "const meals = {}; let currentMeal = ''; document.querySelectorAll('.diary-table tr, [class*=\"diary\"] tr, table tr').forEach(row => { const mealHeader = row.querySelector('.meal_header, th[class*=\"meal\"], td.first.alt'); if (mealHeader) { currentMeal = mealHeader.textContent?.trim() || ''; meals[currentMeal] = []; return; } if (currentMeal) { const nameEl = row.querySelector('a.js-show-food-diary, td.first a, [class*=\"food-name\"]'); const calEl = row.querySelector('td.delete + td, [class*=\"calorie\"]'); if (nameEl) meals[currentMeal].push({ food: nameEl.textContent?.trim() || '', calories: calEl?.textContent?.trim() || '' }); } }); return { date: '{{date}}', meals, url: window.location.href };",
      "name": "result",
      "label": "Extract data"
    }
  ]
}
