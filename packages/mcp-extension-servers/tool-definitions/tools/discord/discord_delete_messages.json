{
  "id": "discord-delete-messages",
  "name": "discord_delete_messages",
  "description": "Delete your own recent messages in a Discord channel by right-clicking each message and selecting Delete. Only deletes messages sent by you.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "channel_url",
      "type": "string",
      "description": "Discord channel URL where your messages are",
      "required": true
    },
    {
      "name": "count",
      "type": "number",
      "description": "Number of your messages to delete (1-10)",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "{{channel_url}}",
      "label": "Open Discord channel"
    },
    {
      "action": "waitForSelector",
      "selector": "ol[data-list-id='chat-messages']",
      "timeout": 15000,
      "label": "Wait for messages"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "code",
      "code": "const maxDelete = Math.min(parseInt('{{count}}') || 3, 10); let deleted = 0; const chatList = document.querySelector('ol[data-list-id=\"chat-messages\"]'); if (!chatList) return { success: false, deleted_count: 0, message: 'Chat list not found' }; const msgEls = Array.from(chatList.querySelectorAll('li[id^=\"chat-messages-\"]')).reverse(); for (const el of msgEls) { if (deleted >= maxDelete) break; const hoverBtns = el.querySelector('div[role=\"toolbar\"], div[aria-label=\"Message Actions\"]'); if (!hoverBtns) { el.dispatchEvent(new MouseEvent('mouseenter', { bubbles: true })); await new Promise(r => setTimeout(r, 500)); } const moreBtn = el.querySelector('button[aria-label=\"More\"], button[aria-label*=\"more\"]') || el.querySelector('div[role=\"toolbar\"] button:last-child'); if (!moreBtn) continue; moreBtn.click(); await new Promise(r => setTimeout(r, 500)); const menuItems = document.querySelectorAll('[role=\"menuitem\"], [id*=\"message-actions\"] [role=\"button\"]'); let deleteBtn = null; for (const item of menuItems) { const text = item.textContent.trim().toLowerCase(); if (text.includes('delete') && !text.includes('thread')) { deleteBtn = item; break; } } if (!deleteBtn) { document.dispatchEvent(new KeyboardEvent('keydown', { key: 'Escape', bubbles: true })); continue; } deleteBtn.click(); await new Promise(r => setTimeout(r, 500)); const confirmBtn = document.querySelector('button[type=\"submit\"], div[role=\"dialog\"] button:last-child'); const allBtns = document.querySelectorAll('div[role=\"dialog\"] button'); for (const btn of allBtns) { const text = btn.textContent.trim().toLowerCase(); if (text.includes('delete') || text.includes('confirm')) { btn.click(); deleted++; break; } } await new Promise(r => setTimeout(r, 1500)); } return { success: true, deleted_count: deleted, message: 'Deleted ' + deleted + ' messages' }",
      "name": "result",
      "label": "Delete own messages via context menu"
    }
  ]
}
