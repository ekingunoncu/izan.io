{
  "id": "discord-send-message",
  "name": "discord_send_message",
  "description": "Send a message in a Discord channel. You must be logged in and have permission to send messages in the channel.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "channel_url",
      "type": "string",
      "description": "Discord channel URL (e.g. 'https://discord.com/channels/123/456')",
      "required": true
    },
    {
      "name": "message",
      "type": "string",
      "description": "Message text to send",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "{{channel_url}}",
      "label": "Open Discord channel"
    },
    {
      "action": "waitForSelector",
      "selector": "div[role='textbox'], [class*='slateTextArea']",
      "timeout": 15000,
      "label": "Wait for message input"
    },
    {
      "action": "wait",
      "ms": 1500,
      "label": "Let channel load"
    },
    {
      "action": "code",
      "code": "const el = document.querySelector('div[role=\"textbox\"][contenteditable=\"true\"]'); if (!el) throw new Error('Message input not found'); el.focus(); document.execCommand('insertText', false, `{{message}}`); el.dispatchEvent(new Event('input', {bubbles: true})); return { typed: true }",
      "name": "type_message",
      "label": "Type message"
    },
    {
      "action": "wait",
      "ms": 500
    },
    {
      "action": "code",
      "code": "const el = document.querySelector('div[role=\"textbox\"]'); if (el) { el.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', code: 'Enter', keyCode: 13, which: 13, bubbles: true })); } return { success: true, message: 'Message sent' }",
      "name": "result",
      "label": "Press Enter to send"
    },
    {
      "action": "wait",
      "ms": 1500
    }
  ]
}
