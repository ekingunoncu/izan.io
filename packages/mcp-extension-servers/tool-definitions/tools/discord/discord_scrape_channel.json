{
  "id": "discord-scrape-channel",
  "name": "discord_scrape_channel",
  "description": "Scrape recent messages from a Discord channel. Returns up to 20 messages with author, content, and timestamp.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "channel_url",
      "type": "string",
      "description": "Discord channel URL (e.g. 'https://discord.com/channels/123/456')",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "{{channel_url}}",
      "label": "Open Discord channel"
    },
    {
      "action": "waitForSelector",
      "selector": "ol[data-list-id='chat-messages']",
      "timeout": 15000,
      "label": "Wait for messages to load"
    },
    {
      "action": "wait",
      "ms": 2000,
      "label": "Let messages render"
    },
    {
      "action": "code",
      "code": "const messages = []; const chatList = document.querySelector('ol[data-list-id=\"chat-messages\"]'); if (!chatList) return { message_count: 0, channel_url: window.location.href, messages: [] }; const msgEls = chatList.querySelectorAll('li[id^=\"chat-messages-\"]'); for (let i = Math.max(0, msgEls.length - 20); i < msgEls.length; i++) { const el = msgEls[i]; const headerEl = el.querySelector('h3'); const authorEl = headerEl ? headerEl.querySelector('span[id^=\"message-username-\"]') : null; const contentEl = el.querySelector('div[id^=\"message-content-\"]'); const timeEl = el.querySelector('time'); if (contentEl && contentEl.textContent.trim()) { messages.push({ author: authorEl ? authorEl.textContent.trim() : '', content: contentEl.textContent.trim(), timestamp: timeEl ? timeEl.getAttribute('datetime') || timeEl.textContent.trim() : '' }); } } return { message_count: messages.length, channel_url: window.location.href, messages: messages }",
      "name": "channel_messages",
      "label": "Extract messages"
    }
  ]
}
