{
  "id": "twitch-search",
  "name": "twitch_search",
  "description": "Search for channels, streams, and categories on Twitch. Returns up to 15 results with channel name, game, viewer count, thumbnail, and URL.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "query",
      "type": "string",
      "description": "Search query (e.g. 'Fortnite', 'speedrun', 'music streams')",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "https://www.twitch.tv/search?term={{query}}",
      "label": "Search Twitch"
    },
    {
      "action": "waitForSelector",
      "selector": "[class*='search-result'], [class*='SearchResults'], [data-a-target*='search']",
      "timeout": 15000,
      "label": "Wait for search results"
    },
    {
      "action": "wait",
      "ms": 2000,
      "label": "Let results render"
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1000,
      "label": "Scroll to load more"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "code",
      "code": "const results = []; const cards = document.querySelectorAll('[class*=\"search-result\"] article, [class*=\"SearchResultCard\"], [data-a-target*=\"search-result\"], [class*=\"tw-tower\"] > div'); for (let i = 0; i < Math.min(cards.length, 15); i++) { const el = cards[i]; const nameEl = el.querySelector('a[data-a-target=\"preview-card-channel-link\"], [class*=\"channel-name\"], h3, [data-a-target=\"preview-card-title-link\"]'); const gameEl = el.querySelector('[data-a-target=\"preview-card-game-link\"], [class*=\"game-name\"], a[href*=\"/directory/\"]'); const viewersEl = el.querySelector('[class*=\"viewer\"], [class*=\"stream-viewers\"], [aria-label*=\"viewer\"]'); const linkEl = el.querySelector('a[href]'); const imgEl = el.querySelector('img'); const liveEl = el.querySelector('[class*=\"live\"], [class*=\"LiveIndicator\"]'); results.push({ name: nameEl ? nameEl.textContent.trim() : '', game: gameEl ? gameEl.textContent.trim() : '', viewers: viewersEl ? viewersEl.textContent.trim() : '', is_live: !!liveEl, url: linkEl ? linkEl.href : '', thumbnail: imgEl ? imgEl.getAttribute('src') : '' }); } return { query: `{{query}}`, result_count: results.length, results: results }",
      "name": "search_results",
      "label": "Extract search results"
    }
  ]
}