{
  "id": "threads-search",
  "name": "threads_search",
  "description": "Search for posts on Threads. Returns up to 15 results with author, content preview, likes, replies, and URL. You must be logged in to Threads.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "query",
      "type": "string",
      "description": "Search query (e.g. 'artificial intelligence', 'tech news', 'photography')",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "https://www.threads.net/search?q={{query}}&serp_type=default",
      "label": "Search Threads"
    },
    {
      "action": "waitForSelector",
      "selector": "[class*='ThreadItem'], [class*='thread'], article, div[role='article']",
      "timeout": 15000,
      "label": "Wait for search results"
    },
    {
      "action": "wait",
      "ms": 3000,
      "label": "Let results render"
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1500,
      "label": "Scroll to load more results"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1500,
      "label": "Scroll further"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "code",
      "code": "const results = []; const posts = document.querySelectorAll('[class*=\"ThreadItem\"], article, div[role=\"article\"], [data-pressable-container=\"true\"]'); const seen = new Set(); for (let i = 0; i < posts.length && results.length < 15; i++) { const el = posts[i]; const authorEl = el.querySelector('a[href^=\"/@\"] span, a[href*=\"threads.net/@\"] span, [class*=\"username\"], span[class*=\"author\"]'); const author = authorEl ? authorEl.textContent.trim() : ''; const authorLink = el.querySelector('a[href^=\"/@\"], a[href*=\"threads.net/@\"]'); const authorUrl = authorLink ? (authorLink.href.startsWith('http') ? authorLink.href : 'https://www.threads.net' + authorLink.getAttribute('href')) : ''; const contentEl = el.querySelector('[class*=\"text\"], [class*=\"content\"], [class*=\"body\"] span, [dir=\"auto\"] span, [class*=\"TextContent\"]'); let content = ''; if (contentEl) { content = contentEl.textContent.trim().substring(0, 300); } else { const spans = el.querySelectorAll('span[dir=\"auto\"]'); for (const span of spans) { const text = span.textContent.trim(); if (text.length > content.length && text !== author) content = text.substring(0, 300); } } const timeEl = el.querySelector('time, [class*=\"time\"], [class*=\"timestamp\"], a[href*=\"/post/\"] time'); const timestamp = timeEl ? (timeEl.getAttribute('datetime') || timeEl.textContent.trim()) : ''; const likesEl = el.querySelector('[class*=\"like\"] span, [aria-label*=\"like\"], [class*=\"LikeCount\"]'); const likes = likesEl ? (likesEl.getAttribute('aria-label') || likesEl.textContent.trim()) : ''; const repliesEl = el.querySelector('[class*=\"reply\"] span, [aria-label*=\"repl\"], [class*=\"ReplyCount\"]'); const replies = repliesEl ? (repliesEl.getAttribute('aria-label') || repliesEl.textContent.trim()) : ''; const postLink = el.querySelector('a[href*=\"/post/\"], a[href*=\"/t/\"]'); const postUrl = postLink ? (postLink.href.startsWith('http') ? postLink.href : 'https://www.threads.net' + postLink.getAttribute('href')) : ''; const imgEl = el.querySelector('img[src*=\"scontent\"], img[class*=\"media\"]'); const image = imgEl ? imgEl.src : ''; const identifier = author + content.substring(0, 50); if (content && !seen.has(identifier)) { seen.add(identifier); results.push({ author: author, author_url: authorUrl, content: content, likes: likes, replies: replies, timestamp: timestamp, image: image, post_url: postUrl }); } } return { query: `{{query}}`, result_count: results.length, results: results }",
      "name": "search_results",
      "label": "Extract search results"
    }
  ]
}