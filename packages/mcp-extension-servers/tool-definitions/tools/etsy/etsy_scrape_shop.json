{
  "id": "etsy-scrape-shop",
  "name": "etsy_scrape_shop",
  "description": "Scrape an Etsy shop profile page. Returns shop name, description, total sales, rating, review count, location, active listings count, and featured items.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "shop_name",
      "type": "string",
      "description": "Etsy shop name (e.g. 'MyHandmadeShop', the part after /shop/ in the URL)",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "https://www.etsy.com/shop/{{shop_name}}",
      "label": "Open shop page"
    },
    {
      "action": "waitForSelector",
      "selector": "[class*='shop-name'], h1, [class*='ShopHome'], [data-shop-name]",
      "timeout": 15000,
      "label": "Wait for shop page to load"
    },
    {
      "action": "wait",
      "ms": 2000,
      "label": "Let page fully render"
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1000,
      "label": "Scroll to load listings"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1000,
      "label": "Scroll further down"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "code",
      "code": "const nameEl = document.querySelector('[class*=\"shop-name\"] h1, h1[class*=\"shop\"], [data-shop-name], .wt-text-heading-01'); const descriptionEl = document.querySelector('[class*=\"announcement\"], [class*=\"shop-about\"], [class*=\"shop-description\"], [class*=\"about-section\"]'); const salesEl = document.querySelector('[class*=\"shop-sales\"], [class*=\"sales-count\"], span[class*=\"shop\"][class*=\"sales\"]'); const ratingEl = document.querySelector('[class*=\"shop-rating\"], [class*=\"rating\"] input, [data-rating], [class*=\"stars\"] [class*=\"screen-reader\"]'); const reviewCountEl = document.querySelector('[class*=\"review-count\"], a[href*=\"reviews\"] span, [class*=\"reviews\"]'); const locationEl = document.querySelector('[class*=\"shop-location\"], [class*=\"shopLocation\"]'); const imgEl = document.querySelector('[class*=\"shop-icon\"] img, [class*=\"shop-avatar\"] img, [class*=\"shop-logo\"] img'); const memberSinceEl = document.querySelector('[class*=\"member-since\"], [class*=\"memberSince\"]'); const ownerEl = document.querySelector('[class*=\"shop-owner\"] a, [class*=\"owner-name\"]'); const listings = []; const listingEls = document.querySelectorAll('.v2-listing-card, [class*=\"listing-card\"], [data-listing-id]'); for (let i = 0; i < Math.min(listingEls.length, 12); i++) { const el = listingEls[i]; const titleEl = el.querySelector('h3, [class*=\"title\"], a[title]'); const priceEl = el.querySelector('[class*=\"price\"] .currency-value, span[class*=\"price\"]'); const currencyEl = el.querySelector('.currency-symbol'); const linkEl = el.querySelector('a[href*=\"/listing/\"]'); const imgEl = el.querySelector('img'); listings.push({ title: titleEl ? (titleEl.getAttribute('title') || titleEl.textContent.trim()) : '', price: (currencyEl ? currencyEl.textContent.trim() : '') + (priceEl ? priceEl.textContent.trim() : ''), url: linkEl ? linkEl.href : '', image: imgEl ? imgEl.getAttribute('src') : '' }); } const sectionEls = document.querySelectorAll('[class*=\"shop-section\"] a, [class*=\"section-nav\"] a'); const sections = []; sectionEls.forEach(function(el) { const text = el.textContent.trim(); if (text && text.length < 100) sections.push(text); }); return { name: nameEl ? nameEl.textContent.trim() : '{{shop_name}}', description: descriptionEl ? descriptionEl.textContent.trim().substring(0, 1000) : '', total_sales: salesEl ? salesEl.textContent.trim() : '', rating: ratingEl ? (ratingEl.getAttribute('value') || ratingEl.textContent.trim()) : '', review_count: reviewCountEl ? reviewCountEl.textContent.trim() : '', location: locationEl ? locationEl.textContent.trim() : '', owner: ownerEl ? ownerEl.textContent.trim() : '', member_since: memberSinceEl ? memberSinceEl.textContent.trim() : '', image: imgEl ? imgEl.getAttribute('src') : '', sections: sections.slice(0, 15), listing_count: listings.length, listings: listings, shop_url: window.location.href }",
      "name": "shop_data",
      "label": "Extract shop profile"
    }
  ]
}