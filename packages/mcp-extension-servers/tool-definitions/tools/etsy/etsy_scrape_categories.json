{
  "id": "etsy-scrape-categories",
  "name": "etsy_scrape_categories",
  "description": "Browse and scrape Etsy category pages. Returns featured listings, subcategories, and trending items within a category.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "category",
      "type": "string",
      "description": "Category slug (e.g. 'jewelry', 'home-and-living', 'clothing', 'art-and-collectibles', 'craft-supplies-and-tools')",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "https://www.etsy.com/c/{{category}}",
      "label": "Open category page"
    },
    {
      "action": "waitForSelector",
      "selector": "[class*='listing-card'], .v2-listing-card, h1, [class*='category']",
      "timeout": 15000,
      "label": "Wait for category page to load"
    },
    {
      "action": "wait",
      "ms": 2000,
      "label": "Let page render"
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1200,
      "label": "Scroll to load more content"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1200,
      "label": "Scroll further down"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "code",
      "code": "const headingEl = document.querySelector('h1, [class*=\"category-title\"], [class*=\"heading\"]'); const subcategoryEls = document.querySelectorAll('[class*=\"subcategory\"] a, [class*=\"sub-nav\"] a, [class*=\"category-nav\"] a, nav[class*=\"category\"] a'); const subcategories = []; subcategoryEls.forEach(function(el) { const text = el.textContent.trim(); const href = el.getAttribute('href') || ''; if (text && text.length < 100 && href.includes('/c/')) { subcategories.push({ name: text, url: href.startsWith('http') ? href : 'https://www.etsy.com' + href }); } }); const listings = []; const listingEls = document.querySelectorAll('.v2-listing-card, [class*=\"listing-card\"], [data-listing-id]'); for (let i = 0; i < Math.min(listingEls.length, 20); i++) { const el = listingEls[i]; const titleEl = el.querySelector('h3, [class*=\"title\"], a[title]'); const priceEl = el.querySelector('[class*=\"price\"] .currency-value, span[class*=\"price\"]'); const currencyEl = el.querySelector('.currency-symbol'); const linkEl = el.querySelector('a[href*=\"/listing/\"]'); const imgEl = el.querySelector('img'); const shopEl = el.querySelector('[class*=\"shop-name\"], p[class*=\"shop\"]'); const ratingEl = el.querySelector('[class*=\"rating\"] span, .wt-screen-reader-only'); const freeShippingEl = el.querySelector('[class*=\"free-shipping\"], [class*=\"freeShipping\"]'); listings.push({ title: titleEl ? (titleEl.getAttribute('title') || titleEl.textContent.trim()) : '', price: (currencyEl ? currencyEl.textContent.trim() : '') + (priceEl ? priceEl.textContent.trim() : ''), url: linkEl ? linkEl.href : '', image: imgEl ? imgEl.getAttribute('src') : '', shop_name: shopEl ? shopEl.textContent.trim() : '', rating: ratingEl ? ratingEl.textContent.trim() : '', free_shipping: !!freeShippingEl }); } return { category: `{{category}}`, heading: headingEl ? headingEl.textContent.trim() : '', subcategory_count: subcategories.length, subcategories: subcategories.slice(0, 20), listing_count: listings.length, listings: listings, url: window.location.href }",
      "name": "category_data",
      "label": "Extract category content"
    }
  ]
}