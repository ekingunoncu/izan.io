{
  "id": "slack-search-messages",
  "name": "slack_search_messages",
  "description": "Search messages across the Slack workspace. Returns matching messages with channel, author, text, and timestamp.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "query",
      "type": "string",
      "description": "Search query (supports Slack search syntax: from:user, in:channel, has:link, before:date, after:date)",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "https://app.slack.com",
      "label": "Open Slack"
    },
    {
      "action": "wait",
      "ms": 3000,
      "label": "Let Slack load"
    },
    {
      "action": "code",
      "code": "const localConfig = localStorage.getItem('localConfig_v2'); if (!localConfig) throw new Error('Not logged into Slack'); const config = JSON.parse(localConfig); const teamId = Object.keys(config.teams)[0]; const token = config.teams[teamId].token; const resp = await fetch('/api/search.messages', { method: 'POST', headers: { 'Authorization': 'Bearer ' + token, 'Content-Type': 'application/x-www-form-urlencoded' }, body: 'query=' + encodeURIComponent(`{{query}}`) + '&count=20' }); const data = await resp.json(); if (!data.ok) throw new Error('Search failed: ' + data.error); const messages = (data.messages?.matches || []).map(m => ({ text: m.text?.substring(0, 200) || '', username: m.username || '', channel: m.channel?.name || '', ts: m.ts, permalink: m.permalink || '' })); return { total: data.messages?.total || 0, result_count: messages.length, messages: messages }",
      "name": "result",
      "label": "Search messages via Slack API"
    }
  ]
}
