{
  "id": "airbnb-scrape-listing",
  "name": "airbnb_scrape_listing",
  "description": "Scrape full listing details from an Airbnb listing page. Returns title, price per night, rating, review count, amenities, host info, description, property type, beds, baths, and images.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "listing_url",
      "type": "string",
      "description": "Airbnb listing URL (e.g. 'https://www.airbnb.com/rooms/12345678')",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "{{listing_url}}",
      "label": "Open listing page"
    },
    {
      "action": "waitForSelector",
      "selector": "[data-section-id='TITLE_DEFAULT'], h1, [data-testid='listing-title']",
      "timeout": 15000,
      "label": "Wait for listing page to load"
    },
    {
      "action": "wait",
      "ms": 3000,
      "label": "Let page fully render"
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1000,
      "label": "Scroll to load more content"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1000,
      "label": "Scroll to amenities section"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1000,
      "label": "Scroll to host section"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "code",
      "code": "const titleEl = document.querySelector('[data-section-id=\"TITLE_DEFAULT\"] h1, h1[elementtiming=\"pageTitle\"], h1'); const subtitleEl = document.querySelector('[data-section-id=\"TITLE_DEFAULT\"] h2, [data-section-id=\"TITLE_DEFAULT\"] span'); const priceEl = document.querySelector('[data-testid=\"book-it-default\"] span._tyxjp1, [data-testid=\"book-it-default\"] ._1y74zjx, span[class*=\"price\"] span'); const ratingEl = document.querySelector('[data-testid=\"pdp-reviews-highlight-banner-host-rating\"] span, span[aria-label*=\"Rating\"], .r1dxllyb span'); const reviewCountEl = document.querySelector('[data-testid=\"pdp-reviews-highlight-banner-host-rating\"] button span, a[href=\"#reviews\"] span, .r1dxllyb button span'); const descriptionEl = document.querySelector('[data-section-id=\"DESCRIPTION_DEFAULT\"] div[data-testid=\"listing-description\"], [data-section-id=\"DESCRIPTION_DEFAULT\"] span, [data-section-id=\"DESCRIPTION_DEFAULT\"]'); const hostNameEl = document.querySelector('[data-section-id=\"HOST_PROFILE_DEFAULT\"] h2, [data-section-id=\"HOST_PROFILE_DEFAULT\"] div h3, .t1pxe1a4'); const hostImgEl = document.querySelector('[data-section-id=\"HOST_PROFILE_DEFAULT\"] img'); const amenities = []; const amenityEls = document.querySelectorAll('[data-section-id=\"AMENITIES_DEFAULT\"] div[class*=\"amenity\"], [data-section-id=\"AMENITIES_DEFAULT\"] ._19xnuo97 div, [data-testid=\"listing-amenity\"]'); amenityEls.forEach(function(el) { const text = el.textContent.trim(); if (text && text.length > 1 && text.length < 100) { amenities.push(text); } }); const detailEls = document.querySelectorAll('[data-section-id=\"OVERVIEW_DEFAULT\"] li, [data-section-id=\"OVERVIEW_DEFAULT\"] span, .lgx66tx span'); const details = []; detailEls.forEach(function(el) { const text = el.textContent.trim(); if (text && text.length > 2 && text.length < 80) { details.push(text); } }); const images = []; const imageEls = document.querySelectorAll('[data-testid=\"photo-viewer-section\"] img, picture img, [data-section-id=\"HERO_DEFAULT\"] img'); imageEls.forEach(function(img) { const src = img.getAttribute('src') || ''; if (src && src.includes('images') && !src.includes('sprite')) { images.push(src); } }); const locationEl = document.querySelector('[data-section-id=\"LOCATION_DEFAULT\"] span, [data-section-id=\"LOCATION_DEFAULT\"] h3'); const checkInEl = document.querySelector('[data-testid=\"change-dates-checkIn\"], [data-testid=\"book-it-default\"] [data-testid=\"datepicker-mergedCheckin\"]'); const checkOutEl = document.querySelector('[data-testid=\"change-dates-checkOut\"], [data-testid=\"book-it-default\"] [data-testid=\"datepicker-mergedCheckout\"]'); const isSuperhost = !!document.querySelector('[aria-label*=\"Superhost\"], [data-testid*=\"superhost\"]'); return { title: titleEl ? titleEl.textContent.trim() : '', subtitle: subtitleEl ? subtitleEl.textContent.trim() : '', price: priceEl ? priceEl.textContent.trim() : '', rating: ratingEl ? ratingEl.textContent.trim() : '', review_count: reviewCountEl ? reviewCountEl.textContent.trim() : '', description: descriptionEl ? descriptionEl.textContent.trim().substring(0, 1500) : '', host: { name: hostNameEl ? hostNameEl.textContent.trim() : '', image: hostImgEl ? hostImgEl.getAttribute('src') : '', is_superhost: isSuperhost }, property_details: [...new Set(details)].slice(0, 10), amenities: [...new Set(amenities)].slice(0, 20), location: locationEl ? locationEl.textContent.trim() : '', images: images.slice(0, 5), url: window.location.href }",
      "name": "listing_data",
      "label": "Extract listing details"
    }
  ]
}