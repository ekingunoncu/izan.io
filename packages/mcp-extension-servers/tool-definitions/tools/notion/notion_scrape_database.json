{
  "id": "notion-scrape-database",
  "name": "notion_scrape_database",
  "description": "Scrape all rows from a Notion database. Returns structured data with all visible properties for each row.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "database_url",
      "type": "string",
      "description": "Notion database URL (e.g. 'https://www.notion.so/abc123?v=def456')",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "{{database_url}}",
      "label": "Open Notion database"
    },
    {
      "action": "waitForSelector",
      "selector": ".notion-table-view, .notion-board-view, .notion-list-view, .notion-collection_view-block",
      "timeout": 15000,
      "label": "Wait for database view"
    },
    {
      "action": "wait",
      "ms": 3000,
      "label": "Let database render"
    },
    {
      "action": "code",
      "code": "const headers = []; document.querySelectorAll('.notion-table-view-header-cell, .notion-collection-column-header').forEach(h => { headers.push(h.textContent?.trim() || ''); }); const rows = []; const rowEls = document.querySelectorAll('.notion-table-view .notion-collection-item, .notion-table-row, .notion-list-item'); for (let i = 0; i < Math.min(rowEls.length, 50); i++) { const row = rowEls[i]; const cells = row.querySelectorAll('.notion-table-view-cell, .notion-collection-property-value, td'); const rowData = {}; cells.forEach((cell, idx) => { const key = headers[idx] || 'col_' + idx; rowData[key] = cell.textContent?.trim()?.substring(0, 200) || ''; }); if (Object.values(rowData).some(v => v)) rows.push(rowData); } return { headers: headers, row_count: rows.length, rows: rows }",
      "name": "result",
      "label": "Extract database rows from DOM"
    }
  ]
}
