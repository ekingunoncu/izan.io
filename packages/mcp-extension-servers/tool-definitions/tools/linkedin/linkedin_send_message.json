{
  "id": "linkedin-send-message",
  "name": "linkedin_send_message",
  "description": "Send a message to an existing LinkedIn connection. You must already be connected with the recipient.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "profile_url",
      "type": "string",
      "description": "LinkedIn profile URL of the person to message",
      "required": true
    },
    {
      "name": "message",
      "type": "string",
      "description": "Message text to send",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "{{profile_url}}",
      "label": "Open profile"
    },
    {
      "action": "waitForSelector",
      "selector": ".text-heading-xlarge",
      "timeout": 15000,
      "label": "Wait for profile"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "code",
      "code": "const msgBtn = document.querySelector('button[aria-label*=\"Message\"], a[href*=\"/messaging/\"]'); if (msgBtn) { msgBtn.click(); return { clicked: true }; } return { clicked: false, message: 'Message button not found - you may not be connected' }",
      "name": "open_message",
      "label": "Click Message button"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "waitForSelector",
      "selector": ".msg-form__contenteditable, div[role='textbox'][contenteditable='true']",
      "timeout": 10000,
      "label": "Wait for message input"
    },
    {
      "action": "code",
      "code": "const el = document.querySelector('.msg-form__contenteditable[contenteditable=\"true\"], .msg-form__contenteditable p, div[role=\"textbox\"][contenteditable=\"true\"]'); if (!el) throw new Error('Message input not found'); el.focus(); document.execCommand('insertText', false, `{{message}}`); el.dispatchEvent(new Event('input', {bubbles: true})); return { typed: true }",
      "name": "type_message",
      "label": "Type message"
    },
    {
      "action": "wait",
      "ms": 500
    },
    {
      "action": "code",
      "code": "const sendBtn = document.querySelector('.msg-form__send-button, button[type=\"submit\"].msg-form__send-button, button.msg-form__send-btn'); if (sendBtn) { sendBtn.click(); return { success: true, message: 'Message sent' }; } return { success: false, message: 'Send button not found' }",
      "name": "result",
      "label": "Send message"
    }
  ]
}
