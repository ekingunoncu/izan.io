{
  "id": "expedia-scrape-hotel",
  "name": "expedia_scrape_hotel",
  "description": "Scrape full hotel details from an Expedia hotel page. Returns name, star rating, guest rating, price, amenities, room types, location, description, and images.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "hotel_url",
      "type": "string",
      "description": "Expedia hotel URL (e.g. 'https://www.expedia.com/Hotel-Name.h12345.Hotel-Information')",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "{{hotel_url}}",
      "label": "Open hotel page"
    },
    {
      "action": "waitForSelector",
      "selector": "h1, [data-stid='content-hotel-title']",
      "timeout": 15000,
      "label": "Wait for hotel page to load"
    },
    {
      "action": "wait",
      "ms": 2000,
      "label": "Let page render"
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1200,
      "label": "Scroll to load content"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1200,
      "label": "Scroll further"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "code",
      "code": "const nameEl = document.querySelector('h1, [data-stid=\"content-hotel-title\"]'); const ratingEl = document.querySelector('span.is-visually-hidden[data-stid*=\"rating\"], [aria-label*=\"rating\"]'); const priceEl = document.querySelector('[data-test-id=\"price-summary-message-line\"] span, [data-stid=\"price-lockup\"] span'); const descEl = document.querySelector('[data-stid=\"content-hotel-description\"], [data-stid=\"about-section\"] p, section[id*=\"about\"] p'); const locationEl = document.querySelector('[data-stid=\"content-hotel-address\"], [aria-label*=\"address\"], address'); const amenityEls = document.querySelectorAll('[data-stid=\"section-room-amenities\"] li, [data-stid=\"amenity-icon\"] span, section[id*=\"amenities\"] li'); const amenities = []; amenityEls.forEach(function(a) { const t = a.textContent.trim(); if (t && t.length < 80) amenities.push(t); }); const roomSection = document.querySelector('[data-stid=\"section-room-list\"]'); const roomEls = roomSection ? roomSection.querySelectorAll('[data-stid*=\"room\"], li, article') : document.querySelectorAll('[data-stid=\"section-room-list\"] li'); const rooms = []; for (let i = 0; i < Math.min(roomEls.length, 5); i++) { const el = roomEls[i]; const rNameEl = el.querySelector('h3, h4, strong'); const rPriceEl = el.querySelector('[data-test-id=\"price-summary-message-line\"] span, span[aria-hidden]'); const featureEls = el.querySelectorAll('li, [data-stid=\"amenity-icon\"] span'); const features = []; featureEls.forEach(function(f) { const ft = f.textContent.trim(); if (ft && ft.length < 60) features.push(ft); }); rooms.push({ name: rNameEl ? rNameEl.textContent.trim() : '', price: rPriceEl ? rPriceEl.textContent.trim() : '', features: features.slice(0, 5) }); } const images = []; const imgEls = document.querySelectorAll('[data-stid*=\"gallery\"] img, [data-stid*=\"media\"] img, [data-stid*=\"carousel\"] img, figure img'); imgEls.forEach(function(img) { const src = img.getAttribute('src') || ''; if (src && src.startsWith('http') && !images.includes(src)) images.push(src); }); const reviewCountEl = document.querySelector('[data-stid=\"reviews\"] span, [aria-label*=\"reviews\"]'); return { name: nameEl ? nameEl.textContent.trim() : '', guest_rating: ratingEl ? ratingEl.textContent.trim() : '', review_count: reviewCountEl ? reviewCountEl.textContent.trim() : '', price: priceEl ? priceEl.textContent.trim() : '', location: locationEl ? locationEl.textContent.trim() : '', description: descEl ? descEl.textContent.trim().substring(0, 1000) : '', amenities: amenities.slice(0, 15), rooms: rooms, images: images.slice(0, 8), url: window.location.href }",
      "name": "hotel_data",
      "label": "Extract hotel details"
    }
  ]
}
