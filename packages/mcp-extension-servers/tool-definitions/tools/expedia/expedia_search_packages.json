{
  "id": "expedia-search-packages",
  "name": "expedia_search_packages",
  "description": "Search for vacation packages (flight + hotel) on Expedia. Returns package deals with price, hotel name, flight details, and savings.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "origin",
      "type": "string",
      "description": "Origin city or airport code (e.g. 'New York', 'LAX')",
      "required": true
    },
    {
      "name": "destination",
      "type": "string",
      "description": "Destination city (e.g. 'Cancun', 'Hawaii', 'Paris')",
      "required": true
    },
    {
      "name": "departure_date",
      "type": "string",
      "description": "Departure date in YYYY-MM-DD format",
      "required": true
    },
    {
      "name": "return_date",
      "type": "string",
      "description": "Return date in YYYY-MM-DD format",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "https://www.expedia.com/go/package/search/FlightHotel/{{departure_date}}/{{return_date}}?FromAirport={{origin}}&Destination={{destination}}&NumRoom=1&NumAdult=2",
      "label": "Search vacation packages"
    },
    {
      "action": "waitForSelector",
      "selector": "[data-stid='lodging-card-responsive'], [data-stid='property-listing'], [data-stid='section-results'] li",
      "timeout": 25000,
      "label": "Wait for package results"
    },
    {
      "action": "wait",
      "ms": 3000,
      "label": "Let results render"
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1000,
      "label": "Scroll to load more"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1000,
      "label": "Scroll further"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "code",
      "code": "const results = []; const items = document.querySelectorAll('[data-stid=\"lodging-card-responsive\"], [data-stid=\"property-listing\"]'); for (let i = 0; i < Math.min(items.length, 15); i++) { const el = items[i]; const hotelEl = el.querySelector('h3, h2'); const priceEl = el.querySelector('[data-test-id=\"price-summary-message-line\"] span, [data-stid=\"price-lockup\"] span'); const savingsEl = el.querySelector('[data-stid*=\"savings\"], [aria-label*=\"savings\"], [data-stid*=\"discount\"]'); const ratingEl = el.querySelector('span.is-visually-hidden, [aria-label*=\"rating\"]'); const imgEl = el.querySelector('img'); const linkEl = el.querySelector('a[data-stid=\"open-hotel-information\"], a[href*=\"Hotel-Information\"], a[href*=\".h\"]'); const flightEl = el.querySelector('[data-stid*=\"flight\"], [aria-label*=\"flight\"]'); const url = linkEl ? (linkEl.href.startsWith('http') ? linkEl.href : 'https://www.expedia.com' + linkEl.getAttribute('href')) : ''; results.push({ hotel_name: hotelEl ? hotelEl.textContent.trim() : '', price: priceEl ? priceEl.textContent.trim() : '', savings: savingsEl ? savingsEl.textContent.trim() : '', rating: ratingEl ? ratingEl.textContent.trim() : '', flight_info: flightEl ? flightEl.textContent.trim() : '', image: imgEl ? imgEl.getAttribute('src') : '', url: url }); } return { origin: `{{origin}}`, destination: `{{destination}}`, departure_date: `{{departure_date}}`, return_date: `{{return_date}}`, result_count: results.length, results: results }",
      "name": "package_results",
      "label": "Extract package results"
    }
  ]
}
