{
  "id": "expedia-search-packages",
  "name": "expedia_search_packages",
  "description": "Search for vacation packages (flight + hotel) on Expedia. Returns package deals with price, hotel name, flight details, and savings.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "origin",
      "type": "string",
      "description": "Origin city or airport code (e.g. 'New York', 'LAX')",
      "required": true
    },
    {
      "name": "destination",
      "type": "string",
      "description": "Destination city (e.g. 'Cancun', 'Hawaii', 'Paris')",
      "required": true
    },
    {
      "name": "departure_date",
      "type": "string",
      "description": "Departure date in YYYY-MM-DD format",
      "required": true
    },
    {
      "name": "return_date",
      "type": "string",
      "description": "Return date in YYYY-MM-DD format",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "https://www.expedia.com/Vacation-Packages?origin={{origin}}&destination={{destination}}&startDate={{departure_date}}&endDate={{return_date}}",
      "label": "Search vacation packages"
    },
    {
      "action": "waitForSelector",
      "selector": "[data-stid='property-listing'], [class*='package'], [class*='listing'], [class*='result']",
      "timeout": 20000,
      "label": "Wait for package results"
    },
    {
      "action": "wait",
      "ms": 3000,
      "label": "Let results render"
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1000,
      "label": "Scroll to load more"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1000,
      "label": "Scroll further"
    },
    {
      "action": "wait",
      "ms": 1500
    },
    {
      "action": "code",
      "code": "const results = []; const items = document.querySelectorAll('[data-stid=\"property-listing\"], [class*=\"package-card\"], [class*=\"listing-item\"], [class*=\"result-card\"]'); for (let i = 0; i < Math.min(items.length, 15); i++) { const el = items[i]; const hotelEl = el.querySelector('h3, h2, [class*=\"hotel-name\"], [class*=\"property-name\"]'); const priceEl = el.querySelector('[class*=\"price\"] span, [class*=\"total-price\"], [class*=\"displayPrice\"]'); const savingsEl = el.querySelector('[class*=\"savings\"], [class*=\"discount\"], [class*=\"deal\"]'); const ratingEl = el.querySelector('[class*=\"rating\"] span, [class*=\"score\"]'); const imgEl = el.querySelector('img[src*=\"images\"], img'); const linkEl = el.querySelector('a[href*=\"Package\"], a[href*=\"package\"], a'); const flightEl = el.querySelector('[class*=\"flight\"], [class*=\"airline\"]'); results.push({ hotel_name: hotelEl ? hotelEl.textContent.trim() : '', price: priceEl ? priceEl.textContent.trim() : '', savings: savingsEl ? savingsEl.textContent.trim() : '', rating: ratingEl ? ratingEl.textContent.trim() : '', flight_info: flightEl ? flightEl.textContent.trim() : '', image: imgEl ? imgEl.getAttribute('src') : '', url: linkEl ? linkEl.href : '' }); } return { origin: `{{origin}}`, destination: `{{destination}}`, departure_date: `{{departure_date}}`, return_date: `{{return_date}}`, result_count: results.length, results: results }",
      "name": "package_results",
      "label": "Extract package results"
    }
  ]
}