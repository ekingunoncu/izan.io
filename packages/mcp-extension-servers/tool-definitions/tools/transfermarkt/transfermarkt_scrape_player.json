{
  "id": "transfermarkt-scrape-player",
  "name": "transfermarkt_scrape_player",
  "description": "Scrape a Transfermarkt player profile.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "player_path",
      "type": "string",
      "description": "Player URL path",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "https://www.transfermarkt.com/{{player_path}}",
      "label": "Open Transfermarkt"
    },
    {
      "action": "waitForSelector",
      "selector": "h1.data-header__headline-wrapper, .data-header, .content",
      "timeout": 15000,
      "label": "Wait for page"
    },
    {
      "action": "wait",
      "ms": 2500,
      "label": "Let page render"
    },
    {
      "action": "code",
      "code": "const headerEl = document.querySelector('h1.data-header__headline-wrapper'); const name = headerEl ? Array.from(headerEl.childNodes).filter(n => n.nodeType === 3 || n.tagName === 'STRONG').map(n => n.textContent.trim()).filter(Boolean).join(' ') : ''; const info = {}; const fields = ['Name in home country','Full name','Date of birth/Age','Place of birth','Height','Citizenship','Position','Foot','Player agent','Current club','Joined','Contract expires','Outfitter']; for (const field of fields) { const labelSpan = Array.from(document.querySelectorAll('span')).find(s => s.textContent.trim().startsWith(field)); if (labelSpan) { const valueSpan = labelSpan.nextElementSibling; if (valueSpan) { const imgs = valueSpan.querySelectorAll('img.flaggenrahmen'); if (imgs.length > 0) { info[field.toLowerCase().replace(/\\//g,'_')] = Array.from(imgs).map(img => img.getAttribute('title')).join(', '); } else { info[field.toLowerCase().replace(/\\//g,'_')] = valueSpan.textContent.trim(); } } } } const birthEl = document.querySelector('span[itemprop=\"birthDate\"]'); if (birthEl) info['date_of_birth'] = birthEl.textContent.trim(); const shirtEl = document.querySelector('span.data-header__shirt-number'); if (shirtEl) info['shirt_number'] = shirtEl.textContent.trim(); const clubEl = document.querySelector('span.data-header__club a'); if (clubEl) info['current_club'] = clubEl.textContent.trim(); const value = document.querySelector('a.data-header__market-value-wrapper')?.textContent?.trim()?.replace(/\\s+/g,' ') || document.querySelector('.tm-player-market-value-development__current-value')?.textContent?.trim() || ''; const imgEl = document.querySelector('img.data-header__profile-image'); const image = imgEl?.getAttribute('src') || ''; return { name, info, market_value: value, image, url: window.location.href };",
      "name": "result",
      "label": "Extract data"
    }
  ]
}
