{
  "id": "whatsapp-send-to-number",
  "name": "whatsapp_send_to_number",
  "description": "Send a WhatsApp message directly to a phone number. The number does not need to be in your contacts.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "phone_number",
      "type": "string",
      "description": "Phone number with country code, no spaces or dashes (e.g. '14155552671')",
      "required": true
    },
    {
      "name": "message",
      "type": "string",
      "description": "Message text to send",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "https://web.whatsapp.com/send",
      "urlParams": {
        "phone": "{{phone_number}}",
        "text": "{{message}}"
      },
      "label": "Open WhatsApp chat with number"
    },
    {
      "action": "waitForSelector",
      "selector": "div[contenteditable='true'][data-tab='10'], footer div[contenteditable='true']",
      "timeout": 30000,
      "label": "Wait for chat to open"
    },
    {
      "action": "wait",
      "ms": 3000,
      "label": "Let chat load"
    },
    {
      "action": "code",
      "code": "const sendBtn = document.querySelector('span[data-icon=\"send\"], button[aria-label=\"Send\"]'); if (sendBtn) { sendBtn.closest('button')?.click() || sendBtn.click(); await new Promise(r => setTimeout(r, 1500)); return { success: true, phone: '{{phone_number}}', message: `{{message}}` }; } const msgBox = document.querySelector('div[contenteditable=\"true\"][data-tab=\"10\"]') || document.querySelector('footer div[contenteditable=\"true\"]'); if (msgBox) { msgBox.dispatchEvent(new KeyboardEvent('keydown', { key: 'Enter', code: 'Enter', keyCode: 13, which: 13, bubbles: true })); await new Promise(r => setTimeout(r, 1500)); return { success: true, phone: '{{phone_number}}', message: `{{message}}` }; } return { success: false, message: 'Could not send - chat may not have loaded properly' }",
      "name": "result",
      "label": "Send message"
    }
  ]
}
