{
  "id": "spotify-scrape-album",
  "name": "spotify_scrape_album",
  "description": "Scrape album details from Spotify including album name, artist, release year, and full track list with durations.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "album_url",
      "type": "string",
      "description": "Spotify album URL (e.g. 'https://open.spotify.com/album/4aawyAB9vmqN3uQ7FjRGTy')",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "{{album_url}}",
      "label": "Open Spotify album page"
    },
    {
      "action": "waitForSelector",
      "selector": "[data-testid=\"tracklist-row\"], [data-testid=\"entityTitle\"]",
      "timeout": 15000,
      "label": "Wait for album page to load"
    },
    {
      "action": "wait",
      "ms": 2500,
      "label": "Let album page fully render"
    },
    {
      "action": "code",
      "code": "const titleEl = document.querySelector('[data-testid=\"entityTitle\"] h1, [data-testid=\"entityTitle\"], h1'); const albumName = titleEl ? titleEl.textContent.trim() : ''; const artistEl = document.querySelector('[data-testid=\"creator-link\"], a[href^=\"/artist\"]'); const artistName = artistEl ? artistEl.textContent.trim() : ''; let year = ''; const metaSpans = document.querySelectorAll('span.encore-text, span'); for (const s of metaSpans) { const match = s.textContent.match(/\\b(19|20)\\d{2}\\b/); if (match) { year = match[0]; break; } } let totalDuration = ''; for (const s of metaSpans) { if (s.textContent.match(/\\d+\\s*(hr|min|hour|minute)/i)) { totalDuration = s.textContent.trim(); break; } } const tracks = []; const rows = document.querySelectorAll('[data-testid=\"tracklist-row\"]'); for (let i = 0; i < rows.length; i++) { const row = rows[i]; const nameEl = row.querySelector('[data-testid=\"internal-track-link\"] div, [data-testid=\"internal-track-link\"], a[href^=\"/track\"] div'); const trackArtistEl = row.querySelector('a[href^=\"/artist\"]'); let duration = ''; const allSpans = row.querySelectorAll('span.encore-text'); for (const s of allSpans) { if (s.textContent.match(/^\\d+:\\d+$/)) { duration = s.textContent.trim(); break; } } tracks.push({ position: i + 1, title: nameEl ? nameEl.textContent.trim() : '', artist: trackArtistEl ? trackArtistEl.textContent.trim() : artistName, duration: duration }); } return { album_name: albumName, artist: artistName, year: year, total_duration: totalDuration, track_count: tracks.length, tracks: tracks }",
      "name": "album_data",
      "label": "Extract album track list"
    }
  ]
}