{
  "id": "figma-bulk-scrape-files",
  "name": "figma_bulk_scrape_files",
  "description": "Scrape multiple Figma files in parallel using concurrent browser tabs. Use this instead of calling figma_scrape_file multiple times. Pass file URLs as a comma-separated string. You must be logged into Figma and have access to all files.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "file_urls",
      "type": "string",
      "description": "Comma-separated Figma file URLs (e.g. 'https://www.figma.com/design/ABC/File1,https://www.figma.com/design/DEF/File2')",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "code",
      "code": "return `{{file_urls}}`.split(',').map(u => ({ url: u.trim() }))",
      "name": "items",
      "label": "Build file URL list"
    },
    {
      "action": "forEachItem",
      "sourceExtract": "items",
      "openMethod": "url",
      "urlField": "url",
      "concurrency": 3,
      "maxItems": 10,
      "waitUntil": "load",
      "label": "Scrape each Figma file in parallel",
      "detailSteps": [
        {
          "action": "waitForSelector",
          "selector": "[class*=\"toolbar\"], [data-testid=\"canvas\"], [class*=\"layers_panel\"]",
          "timeout": 20000,
          "label": "Wait for editor to load"
        },
        {
          "action": "wait",
          "ms": 4000
        },
        {
          "action": "code",
          "code": "const fileName = document.querySelector('[class*=\"filename\"], [data-testid=\"filename\"], [class*=\"file_name\"], .toolbar-title input, [class*=\"toolbar\"] [class*=\"name\"]')?.textContent?.trim() || document.title.replace(' - Figma', '').trim() || ''; const pages = []; const pageItems = document.querySelectorAll('.page_item, [class*=\"page_row\"], [class*=\"pages_panel\"] [class*=\"page_name\"], [data-testid=\"page-name\"]'); pageItems.forEach(p => { pages.push(p.textContent.trim()); }); const layerItems = document.querySelectorAll('[class*=\"layers_panel\"] [class*=\"layer_row\"], [class*=\"object_row\"], [class*=\"layers-panel\"] [class*=\"item\"]'); let frameCount = 0; let componentCount = 0; layerItems.forEach(item => { const iconEl = item.querySelector('[class*=\"icon\"], svg'); const text = iconEl ? iconEl.getAttribute('class') || '' : ''; if (text.includes('frame') || text.includes('Frame')) frameCount++; if (text.includes('component') || text.includes('Component')) componentCount++; }); return { file_name: fileName, url: window.location.href, page_count: pages.length, pages: pages, total_layers_visible: layerItems.length, frame_count: frameCount, component_count: componentCount }",
          "name": "scrape_result",
          "label": "Extract file details"
        }
      ]
    }
  ]
}
