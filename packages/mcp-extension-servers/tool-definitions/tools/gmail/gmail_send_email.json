{
  "id": "gmail-send-email",
  "name": "gmail_send_email",
  "description": "Compose and send an email via Gmail. Opens Gmail, clicks the compose button, fills in the recipient, subject, and body fields, and clicks send. You must be logged in to Gmail.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "to",
      "type": "string",
      "description": "Recipient email address",
      "required": true
    },
    {
      "name": "subject",
      "type": "string",
      "description": "Email subject line",
      "required": true
    },
    {
      "name": "body",
      "type": "string",
      "description": "Email body text",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "https://mail.google.com/mail/u/0/#inbox",
      "label": "Open Gmail"
    },
    {
      "action": "waitForSelector",
      "selector": "[gh='cm'], .T-I.T-I-KE[role='button']",
      "timeout": 15000,
      "label": "Wait for Gmail to load"
    },
    {
      "action": "wait",
      "ms": 2000,
      "label": "Let Gmail fully initialize"
    },
    {
      "action": "code",
      "code": "const composeBtn = document.querySelector('[gh=\"cm\"]') || document.querySelector('.T-I.T-I-KE[role=\"button\"]'); if (composeBtn) { composeBtn.click(); } else { throw new Error('Compose button not found'); } return { clicked: true }",
      "name": "open_compose",
      "label": "Click compose button"
    },
    {
      "action": "wait",
      "ms": 2000,
      "label": "Wait for compose window to open"
    },
    {
      "action": "waitForSelector",
      "selector": "[aria-label='To recipients'], input[name='to']",
      "timeout": 10000,
      "label": "Wait for compose form"
    },
    {
      "action": "code",
      "code": "const toInput = document.querySelector('[aria-label=\"To recipients\"]') || document.querySelector('input[name=\"to\"]') || document.querySelector('textarea[name=\"to\"]'); if (toInput) { toInput.focus(); await new Promise(r => setTimeout(r, 300)); document.execCommand('insertText', false, `{{to}}`); toInput.dispatchEvent(new Event('input', { bubbles: true })); await new Promise(r => setTimeout(r, 500)); toInput.dispatchEvent(new KeyboardEvent('keydown', { key: 'Tab', code: 'Tab', keyCode: 9, which: 9, bubbles: true })); } return { to_filled: true }",
      "name": "fill_to",
      "label": "Fill in recipient"
    },
    {
      "action": "wait",
      "ms": 500
    },
    {
      "action": "code",
      "code": "const subjectInput = document.querySelector('input[name=\"subjectbox\"]'); if (subjectInput) { subjectInput.focus(); await new Promise(r => setTimeout(r, 300)); document.execCommand('insertText', false, `{{subject}}`); subjectInput.dispatchEvent(new Event('input', { bubbles: true })); } return { subject_filled: true }",
      "name": "fill_subject",
      "label": "Fill in subject"
    },
    {
      "action": "wait",
      "ms": 500
    },
    {
      "action": "code",
      "code": "const bodyDiv = document.querySelector('div[aria-label=\"Message Body\"]') || document.querySelector('.Am.Al.editable'); if (bodyDiv) { bodyDiv.focus(); await new Promise(r => setTimeout(r, 300)); document.execCommand('insertText', false, `{{body}}`); bodyDiv.dispatchEvent(new Event('input', { bubbles: true })); } return { body_filled: true }",
      "name": "fill_body",
      "label": "Fill in message body"
    },
    {
      "action": "wait",
      "ms": 1000,
      "label": "Wait before sending"
    },
    {
      "action": "code",
      "code": "const composeBox = document.querySelector('.M9, .AD'); const sendBtn = (composeBox && composeBox.querySelector('[aria-label*=\"Send\"]')) || document.querySelector('.T-I.aoO') || document.querySelector('.dC .T-I[aria-label*=\"Send\"]'); if (sendBtn) { sendBtn.click(); } else { throw new Error('Send button not found'); } return { success: true, message: 'Email sent', to: `{{to}}`, subject: `{{subject}}` }",
      "name": "result",
      "label": "Click send"
    },
    {
      "action": "wait",
      "ms": 2000,
      "label": "Wait for email to be sent"
    }
  ]
}