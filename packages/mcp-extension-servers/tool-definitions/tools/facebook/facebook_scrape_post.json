{
  "id": "facebook-scrape-post",
  "name": "facebook_scrape_post",
  "description": "Scrape a Facebook post. Returns the post content, author, timestamp, reaction counts, comment count, share count, and top comments.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "post_url",
      "type": "string",
      "description": "Facebook post URL (e.g. 'https://www.facebook.com/username/posts/123456')",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "{{post_url}}",
      "label": "Open Facebook post"
    },
    {
      "action": "waitForSelector",
      "selector": "[role='article'], [role='main'], [data-ad-preview]",
      "timeout": 15000,
      "label": "Wait for post to load"
    },
    {
      "action": "wait",
      "ms": 3000,
      "label": "Let post fully render"
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 600,
      "label": "Scroll to load comments"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 800,
      "label": "Scroll further for more comments"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "code",
      "code": "const article = document.querySelector('[role=\"article\"], [role=\"main\"]'); let author = ''; let content = ''; let timestamp = ''; let reactions = ''; let commentCount = ''; let shareCount = ''; if (article) { const authorEl = article.querySelector('h2 a, h3 a, strong a, a[role=\"link\"] span'); if (authorEl) { author = authorEl.textContent.trim(); } const textEls = article.querySelectorAll('div[dir=\"auto\"]'); for (const t of textEls) { const txt = t.textContent.trim(); if (txt.length > 20 && txt !== author) { content = txt.substring(0, 2000); break; } } const timeEl = article.querySelector('abbr, a[href*=\"/posts/\"] span, span[id] a'); if (timeEl) { timestamp = timeEl.textContent.trim() || timeEl.getAttribute('title') || ''; } const spans = article.querySelectorAll('span'); for (const span of spans) { const text = span.textContent.trim().toLowerCase(); if ((text.includes('like') || text.includes('reaction') || /^[\\d,.]+[kmb]?$/.test(text)) && span.closest('[aria-label*=\"reaction\"], [aria-label*=\"like\"]')) { reactions = span.textContent.trim(); } if (text.includes('comment') && /\\d/.test(text)) { commentCount = span.textContent.trim(); } if (text.includes('share') && /\\d/.test(text)) { shareCount = span.textContent.trim(); } } const reactionLabel = article.querySelector('[aria-label*=\"reaction\"], [aria-label*=\"like\"], [aria-label*=\"Love\"]'); if (reactionLabel && !reactions) { reactions = reactionLabel.getAttribute('aria-label') || ''; } } const comments = []; const commentEls = document.querySelectorAll('ul[role=\"list\"] li, div[role=\"article\"] div[role=\"article\"]'); for (let i = 0; i < Math.min(commentEls.length, 10); i++) { const c = commentEls[i]; const cAuthor = c.querySelector('a[role=\"link\"] span, a[role=\"link\"][tabindex=\"0\"] span'); const cText = c.querySelector('div[dir=\"auto\"], span[dir=\"auto\"]'); const cTime = c.querySelector('abbr, a[href*=\"comment_id\"]'); if (cText && cText.textContent.trim().length > 2) { comments.push({ author: cAuthor ? cAuthor.textContent.trim() : '', content: cText.textContent.trim().substring(0, 500), time: cTime ? cTime.textContent.trim() : '' }); } } return { author: author, content: content, timestamp: timestamp, reactions: reactions, comment_count: commentCount, share_count: shareCount, comments_scraped: comments.length, comments: comments, post_url: window.location.href }",
      "name": "post_data",
      "label": "Extract post details and comments"
    }
  ]
}