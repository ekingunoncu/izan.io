{
  "id": "booking-scrape-availability",
  "name": "booking_scrape_availability",
  "description": "Check room availability for a Booking.com hotel for specific dates. Returns available room types with prices, bed configurations, max occupancy, amenities, and booking conditions.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "hotel_url",
      "type": "string",
      "description": "Booking.com hotel URL (e.g. 'https://www.booking.com/hotel/fr/example-paris.html')",
      "required": true
    },
    {
      "name": "checkin",
      "type": "string",
      "description": "Check-in date in YYYY-MM-DD format (e.g. '2025-06-15')",
      "required": true
    },
    {
      "name": "checkout",
      "type": "string",
      "description": "Check-out date in YYYY-MM-DD format (e.g. '2025-06-18')",
      "required": true
    },
    {
      "name": "guests",
      "type": "string",
      "description": "Number of guests (e.g. '2'). Defaults to 2 if not specified.",
      "required": false
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "{{hotel_url}}?checkin={{checkin}}&checkout={{checkout}}&group_adults={{guests}}&no_rooms=1",
      "label": "Open hotel page with dates and guests"
    },
    {
      "action": "waitForSelector",
      "selector": "h2.pp-header__title, [data-testid='header-title'], .hp__hotel-name, #hp_hotel_name",
      "timeout": 15000,
      "label": "Wait for hotel page to load"
    },
    {
      "action": "wait",
      "ms": 3000,
      "label": "Let availability data render"
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1500,
      "label": "Scroll to availability table"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1000,
      "label": "Scroll further for all room options"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "code",
      "code": "const nameEl = document.querySelector('h2.pp-header__title, [data-testid=\"header-title\"], .hp__hotel-name, #hp_hotel_name'); const hotelName = nameEl ? nameEl.textContent.trim() : ''; const soldOutEl = document.querySelector('[data-testid=\"no-availability-message\"], .sold-out-message, .hp--soldout, #availability_warning'); const isSoldOut = !!soldOutEl; const rooms = []; const roomBlocks = document.querySelectorAll('.hprt-table tr, [data-testid=\"availability-row\"], table.hprt-table tbody tr, .js-rt-block-row'); roomBlocks.forEach(function(el, idx) { if (idx >= 25) return; const roomNameEl = el.querySelector('.hprt-roomtype-icon-link, [data-testid=\"room-type-link\"], a.hprt-roomtype-link, .room_link strong'); const priceEl = el.querySelector('.hprt-price-price, [data-testid=\"price-and-discounted-price\"], .bui-price-display__value'); const originalPriceEl = el.querySelector('.hprt-price-price-original, .bui-price-display__original'); const occupancyEl = el.querySelector('.hprt-occupancy-occupancy-info, [data-testid=\"occupancy-popup\"]'); const bedEl = el.querySelector('.hprt-roomtype-bed, .hprt-bedcell, [data-testid=\"bed-type\"]'); const mealEl = el.querySelector('.hprt-mealplan, [data-testid=\"meal-plan\"], .hprt-board-type'); const cancellationEl = el.querySelector('.hprt-conditions, [data-testid=\"cancellation-policy\"]'); const roomSizeEl = el.querySelector('.hprt-roomtype-room-size, [data-testid=\"room-size\"]'); const roomFacilities = []; const facilityEls = el.querySelectorAll('.hprt-facilities-facility, [data-testid=\"room-facility\"] span'); facilityEls.forEach(function(f) { const text = f.textContent.trim(); if (text && text.length > 1) roomFacilities.push(text); }); const selectEl = el.querySelector('.hprt-nos-select, select[data-testid=\"select-room-trigger\"]'); const isAvailable = !el.querySelector('.hprt-sold-out, [data-testid=\"sold-out\"]'); if (roomNameEl || priceEl) { rooms.push({ room_type: roomNameEl ? roomNameEl.textContent.trim() : '', price: priceEl ? priceEl.textContent.trim() : '', original_price: originalPriceEl ? originalPriceEl.textContent.trim() : '', bed_type: bedEl ? bedEl.textContent.trim() : '', max_occupancy: occupancyEl ? occupancyEl.textContent.trim() : '', room_size: roomSizeEl ? roomSizeEl.textContent.trim() : '', meal_plan: mealEl ? mealEl.textContent.trim() : '', cancellation: cancellationEl ? cancellationEl.textContent.trim().substring(0, 200) : '', facilities: roomFacilities.slice(0, 10), available: isAvailable }); } }); const taxInfoEl = document.querySelector('.hprt-price-tax-rate, [data-testid=\"taxes-and-charges\"]'); return { hotel_name: hotelName, checkin: `{{checkin}}`, checkout: `{{checkout}}`, guests: `{{guests}}` || '2', is_sold_out: isSoldOut, sold_out_message: soldOutEl ? soldOutEl.textContent.trim() : '', tax_info: taxInfoEl ? taxInfoEl.textContent.trim() : '', available_room_count: rooms.filter(function(r) { return r.available; }).length, total_room_count: rooms.length, rooms: rooms, url: window.location.href }",
      "name": "availability_data",
      "label": "Extract room availability"
    }
  ]
}