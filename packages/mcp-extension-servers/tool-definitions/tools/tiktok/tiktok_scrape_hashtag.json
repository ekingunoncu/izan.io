{
  "id": "tiktok-scrape-hashtag",
  "name": "tiktok_scrape_hashtag",
  "description": "Scrape a TikTok hashtag page. Returns the hashtag view count and top videos associated with the hashtag.",
  "version": "1.0.0",
  "parameters": [
    {
      "name": "hashtag",
      "type": "string",
      "description": "Hashtag without # (e.g. 'fyp', 'dance', 'cooking')",
      "required": true
    }
  ],
  "steps": [
    {
      "action": "navigate",
      "url": "https://www.tiktok.com/tag/{{hashtag}}",
      "label": "Open hashtag page"
    },
    {
      "action": "waitForSelector",
      "selector": "[data-e2e=\"challenge-item\"], [data-e2e=\"challenge-vcard\"], div[class*=\"DivVideoCard\"]",
      "timeout": 15000,
      "label": "Wait for hashtag page to load"
    },
    {
      "action": "wait",
      "ms": 3000,
      "label": "Let page fully render"
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1000,
      "label": "Scroll to load more videos"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "scroll",
      "direction": "down",
      "amount": 1000,
      "label": "Scroll for additional content"
    },
    {
      "action": "wait",
      "ms": 2000
    },
    {
      "action": "code",
      "code": "const viewCountEl = document.querySelector('[data-e2e=\"challenge-vcount\"], [data-e2e=\"challenge-view-count\"], strong[class*=\"StrongNumber\"], h2[class*=\"H2ShareSubTitle\"]'); const descEl = document.querySelector('[data-e2e=\"challenge-desc\"], p[class*=\"PDesc\"], .challenge-description'); const videos = []; const items = document.querySelectorAll('[data-e2e=\"challenge-item\"], [data-e2e=\"challenge-vcard\"], div[class*=\"DivVideoCardBody\"], div[class*=\"DivWrapper\"] > div[class*=\"DivVideoCard\"]'); for (let i = 0; i < Math.min(items.length, 15); i++) { const el = items[i]; const descItemEl = el.querySelector('[data-e2e=\"challenge-item-desc\"], a[title], .card-desc'); const creatorEl = el.querySelector('[data-e2e=\"challenge-item-username\"], [data-e2e=\"creator-uniqueid\"], .author-uniqueid, p[class*=\"PAuthorTitle\"]'); const viewsEl = el.querySelector('[data-e2e=\"video-views\"], strong.video-count, .view-count, span[class*=\"SpanCount\"]'); const thumbEl = el.querySelector('img[src*=\"tiktokcdn\"], img.poster, picture img'); const linkEl = el.querySelector('a[href*=\"/video/\"], a[href*=\"/@\"]'); videos.push({ description: descItemEl ? (descItemEl.getAttribute('title') || descItemEl.textContent.trim()).substring(0, 300) : '', creator: creatorEl ? creatorEl.textContent.trim() : '', views: viewsEl ? viewsEl.textContent.trim() : '', thumbnail: thumbEl ? thumbEl.src : '', url: linkEl ? linkEl.href : '' }); } return { hashtag: '{{hashtag}}', total_views: viewCountEl ? viewCountEl.textContent.trim() : '', description: descEl ? descEl.textContent.trim().substring(0, 500) : '', video_count: videos.length, top_videos: videos }",
      "name": "hashtag_data",
      "label": "Extract hashtag info and top videos"
    }
  ]
}